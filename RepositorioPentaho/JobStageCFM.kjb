<job>
  <name>JobStageCFM</name>
  <description/>
  <extended_description/>
  <job_version/>
  <directory>/</directory>
  <created_user>-</created_user>
  <created_date>2022/08/02 16:40:43.275</created_date>
  <modified_user>-</modified_user>
  <modified_date>2022/08/12 20:01:37.818</modified_date>
  <parameters>
    </parameters>
  <connection>
    <name>CFMLocal</name>
    <server>localhost</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>stagecfm</database>
    <port>3306</port>
    <username>root</username>
    <password>Encrypted </password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.defaultFetchSize</code>
        <attribute>500</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.useCursorFetch</code>
        <attribute>true</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <slaveservers>
    </slaveservers>
  <job-log-table>
    <connection/>
    <schema/>
    <table/>
    <size_limit_lines/>
    <interval/>
    <timeout_days/>
    <field>
      <id>ID_JOB</id>
      <enabled>Y</enabled>
      <name>ID_JOB</name>
    </field>
    <field>
      <id>CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>CHANNEL_ID</name>
    </field>
    <field>
      <id>JOBNAME</id>
      <enabled>Y</enabled>
      <name>JOBNAME</name>
    </field>
    <field>
      <id>STATUS</id>
      <enabled>Y</enabled>
      <name>STATUS</name>
    </field>
    <field>
      <id>LINES_READ</id>
      <enabled>Y</enabled>
      <name>LINES_READ</name>
    </field>
    <field>
      <id>LINES_WRITTEN</id>
      <enabled>Y</enabled>
      <name>LINES_WRITTEN</name>
    </field>
    <field>
      <id>LINES_UPDATED</id>
      <enabled>Y</enabled>
      <name>LINES_UPDATED</name>
    </field>
    <field>
      <id>LINES_INPUT</id>
      <enabled>Y</enabled>
      <name>LINES_INPUT</name>
    </field>
    <field>
      <id>LINES_OUTPUT</id>
      <enabled>Y</enabled>
      <name>LINES_OUTPUT</name>
    </field>
    <field>
      <id>LINES_REJECTED</id>
      <enabled>Y</enabled>
      <name>LINES_REJECTED</name>
    </field>
    <field>
      <id>ERRORS</id>
      <enabled>Y</enabled>
      <name>ERRORS</name>
    </field>
    <field>
      <id>STARTDATE</id>
      <enabled>Y</enabled>
      <name>STARTDATE</name>
    </field>
    <field>
      <id>ENDDATE</id>
      <enabled>Y</enabled>
      <name>ENDDATE</name>
    </field>
    <field>
      <id>LOGDATE</id>
      <enabled>Y</enabled>
      <name>LOGDATE</name>
    </field>
    <field>
      <id>DEPDATE</id>
      <enabled>Y</enabled>
      <name>DEPDATE</name>
    </field>
    <field>
      <id>REPLAYDATE</id>
      <enabled>Y</enabled>
      <name>REPLAYDATE</name>
    </field>
    <field>
      <id>LOG_FIELD</id>
      <enabled>Y</enabled>
      <name>LOG_FIELD</name>
    </field>
    <field>
      <id>EXECUTING_SERVER</id>
      <enabled>N</enabled>
      <name>EXECUTING_SERVER</name>
    </field>
    <field>
      <id>EXECUTING_USER</id>
      <enabled>N</enabled>
      <name>EXECUTING_USER</name>
    </field>
    <field>
      <id>START_JOB_ENTRY</id>
      <enabled>N</enabled>
      <name>START_JOB_ENTRY</name>
    </field>
    <field>
      <id>CLIENT</id>
      <enabled>N</enabled>
      <name>CLIENT</name>
    </field>
  </job-log-table>
  <jobentry-log-table>
    <connection/>
    <schema/>
    <table/>
    <timeout_days/>
    <field>
      <id>ID_BATCH</id>
      <enabled>Y</enabled>
      <name>ID_BATCH</name>
    </field>
    <field>
      <id>CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>CHANNEL_ID</name>
    </field>
    <field>
      <id>LOG_DATE</id>
      <enabled>Y</enabled>
      <name>LOG_DATE</name>
    </field>
    <field>
      <id>JOBNAME</id>
      <enabled>Y</enabled>
      <name>TRANSNAME</name>
    </field>
    <field>
      <id>JOBENTRYNAME</id>
      <enabled>Y</enabled>
      <name>STEPNAME</name>
    </field>
    <field>
      <id>LINES_READ</id>
      <enabled>Y</enabled>
      <name>LINES_READ</name>
    </field>
    <field>
      <id>LINES_WRITTEN</id>
      <enabled>Y</enabled>
      <name>LINES_WRITTEN</name>
    </field>
    <field>
      <id>LINES_UPDATED</id>
      <enabled>Y</enabled>
      <name>LINES_UPDATED</name>
    </field>
    <field>
      <id>LINES_INPUT</id>
      <enabled>Y</enabled>
      <name>LINES_INPUT</name>
    </field>
    <field>
      <id>LINES_OUTPUT</id>
      <enabled>Y</enabled>
      <name>LINES_OUTPUT</name>
    </field>
    <field>
      <id>LINES_REJECTED</id>
      <enabled>Y</enabled>
      <name>LINES_REJECTED</name>
    </field>
    <field>
      <id>ERRORS</id>
      <enabled>Y</enabled>
      <name>ERRORS</name>
    </field>
    <field>
      <id>RESULT</id>
      <enabled>Y</enabled>
      <name>RESULT</name>
    </field>
    <field>
      <id>NR_RESULT_ROWS</id>
      <enabled>Y</enabled>
      <name>NR_RESULT_ROWS</name>
    </field>
    <field>
      <id>NR_RESULT_FILES</id>
      <enabled>Y</enabled>
      <name>NR_RESULT_FILES</name>
    </field>
    <field>
      <id>LOG_FIELD</id>
      <enabled>N</enabled>
      <name>LOG_FIELD</name>
    </field>
    <field>
      <id>COPY_NR</id>
      <enabled>N</enabled>
      <name>COPY_NR</name>
    </field>
  </jobentry-log-table>
  <channel-log-table>
    <connection/>
    <schema/>
    <table/>
    <timeout_days/>
    <field>
      <id>ID_BATCH</id>
      <enabled>Y</enabled>
      <name>ID_BATCH</name>
    </field>
    <field>
      <id>CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>CHANNEL_ID</name>
    </field>
    <field>
      <id>LOG_DATE</id>
      <enabled>Y</enabled>
      <name>LOG_DATE</name>
    </field>
    <field>
      <id>LOGGING_OBJECT_TYPE</id>
      <enabled>Y</enabled>
      <name>LOGGING_OBJECT_TYPE</name>
    </field>
    <field>
      <id>OBJECT_NAME</id>
      <enabled>Y</enabled>
      <name>OBJECT_NAME</name>
    </field>
    <field>
      <id>OBJECT_COPY</id>
      <enabled>Y</enabled>
      <name>OBJECT_COPY</name>
    </field>
    <field>
      <id>REPOSITORY_DIRECTORY</id>
      <enabled>Y</enabled>
      <name>REPOSITORY_DIRECTORY</name>
    </field>
    <field>
      <id>FILENAME</id>
      <enabled>Y</enabled>
      <name>FILENAME</name>
    </field>
    <field>
      <id>OBJECT_ID</id>
      <enabled>Y</enabled>
      <name>OBJECT_ID</name>
    </field>
    <field>
      <id>OBJECT_REVISION</id>
      <enabled>Y</enabled>
      <name>OBJECT_REVISION</name>
    </field>
    <field>
      <id>PARENT_CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>PARENT_CHANNEL_ID</name>
    </field>
    <field>
      <id>ROOT_CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>ROOT_CHANNEL_ID</name>
    </field>
  </channel-log-table>
  <pass_batchid>N</pass_batchid>
  <shared_objects_file/>
  <entries>
    <entry>
      <name>Start</name>
      <description/>
      <type>SPECIAL</type>
      <attributes/>
      <start>Y</start>
      <dummy>N</dummy>
      <repeat>N</repeat>
      <schedulerType>0</schedulerType>
      <intervalSeconds>0</intervalSeconds>
      <intervalMinutes>60</intervalMinutes>
      <hour>12</hour>
      <minutes>0</minutes>
      <weekDay>1</weekDay>
      <DayOfMonth>1</DayOfMonth>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>32</xloc>
      <yloc>16</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>MedicosEmAtividade</name>
      <description/>
      <type>TRANS</type>
      <attributes/>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>MedicosEmAtividade</transname>
      <directory>/</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <run_configuration>Pentaho local</run_configuration>
      <suppress_result_data>N</suppress_result_data>
      <parameters>
        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>144</xloc>
      <yloc>128</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>TabelaOriginal</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>-- Active: 1659469941563@@127.0.0.1@3306@stagecfm
CREATE TABLE MedicosEmAtividade
(
  id BIGINT
, crm BIGINT
, DataInscricaoCRM DATETIME
, TipoDeCRM BIGINT
, ContagemDoCRm BIGINT
, SituacaoDetalhada BIGINT
, SituacaoGeral BIGINT
, UfDeInscricao BIGINT
, Municipio BIGINT
, EstratoMunicipio BIGINT
, ClasseMunicipio BIGINT
, CapitalInterior BIGINT
, RegiaoInscricao BIGINT
, DataNascimento DATETIME
, Idade VARCHAR(200)
, IdadeCatUm BIGINT
, IdadeCatDois BIGINT
, Sexo CHAR(200)
, Sexo_1 VARCHAR(200)
, MunicipioDeNaturalidade VARCHAR(200)
, MunicipioDeNaturalidade_1 BIGINT
, UfDeNaturalidade VARCHAR(200)
, UfDeNaturalidade_1 BIGINT
, RegiaoDeNaturalidade BIGINT
, Pais VARCHAR(200)
, Escola VARCHAR(200)
, UniversidadeOrigem BIGINT
, NaturezaJuridicaEscolaMedica BIGINT
, MunicipioEscolaMedica VARCHAR(200)
, MunicipioEscolaMedica_1 BIGINT
, UfDaEscolaMedica BIGINT
, DataFormatura VARCHAR(200)
, TempoDeFormado BIGINT
, DataSituacaoDetalhada VARCHAR(200)
, MunicipioResidencia BIGINT
, CEPResidencia VARCHAR(200)
, UfDeResidencia BIGINT
, MunicipioResidencia_1 BIGINT
, MunicipioComercial VARCHAR(200)
, CEPMunicipioComercial BIGINT
, UfComercial VARCHAR(200)
, MunicipioComercial_1 BIGINT
, MunicipioDeCorrespondencia VARCHAR(200)
, CEPDeCorrespondecia BIGINT
, UfDeCorrespondecia VARCHAR(200)
, ProgramaResidenciaEmCurso BIGINT
, PrimeiraResidencia BIGINT
, SegundaResidencia BIGINT
, TerceiraResidencia BIGINT
, QuartaResidencia BIGINT
, Especialidade BIGINT
, Acupuntura BIGINT
, AlergiaImunologia BIGINT
, Anestesiologia BIGINT
, Angiologia BIGINT
, Cardiologia BIGINT
, CirurgiaCardiovascular BIGINT
, CirurgiadaMao BIGINT
, CirurgiadeCabecaePescoco BIGINT
, CirurgiadoAparelhoDigestivo BIGINT
, CirurgiaGeral BIGINT
, CirurgiaOncologica BIGINT
, CirurgiaPediatrica BIGINT
, CirurgiaPlastica BIGINT
, CirurgiaToracia BIGINT
, CirurgiaVascular BIGINT
, ClinicaMédica BIGINT
, Coloproctologia BIGINT
, Dermatologia BIGINT
, EndocrinologiaeMetabologia BIGINT
, Endoscopia BIGINT
, Gastroenterologia BIGINT
, GeneticaMedica BIGINT
, Geriatria BIGINT
, GinecologiaeObstetricia BIGINT
, HematologiaeHemoterapia BIGINT
, Homeopatia BIGINT
, Infectologia BIGINT
, Mastologia BIGINT
, MedicinadeEmergência BIGINT
, MedicinaDeFamiliaeComunidade BIGINT
, MedicinaDoTrabalho BIGINT
, MedicinadeTrafego BIGINT
, MedicinaEsportiva BIGINT
, MedicinaFisicaeReabilitacao BIGINT
, MedicinaIntensiva BIGINT
, MedicinaLegalEPericiaMedica BIGINT
, MedicinaNuclear BIGINT
, MedicinaPreventivaESocial BIGINT
, Nefrologia BIGINT
, Neurocirurgia BIGINT
, Neurologia BIGINT
, Nutrologia BIGINT
, Oftalmologia BIGINT
, OncologiaClinica BIGINT
, OrtopediaETraumatologia BIGINT
, Otorrinolaringologia BIGINT
, Patologia BIGINT
, PatologiaClinicaMedicinaLaboratorial BIGINT
, Pediatria BIGINT
, Pneumologia BIGINT
, Psiquiatria BIGINT
, RadiologiaDiagnosticoPorImagem BIGINT
, Radioterapia BIGINT
, Reumatologia BIGINT
, Urologia BIGINT
, EspecialidadesCirurgicas BIGINT
, SAO BIGINT
, total_tit BIGINT);

</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>CFMLocal</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>352</xloc>
      <yloc>16</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>Verificacao</name>
      <description/>
      <type>TABLE_EXISTS</type>
      <attributes/>
      <tablename>medicosematividade</tablename>
      <schemaname>stagecfm</schemaname>
      <connection>CFMLocal</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>144</xloc>
      <yloc>16</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>Success</name>
      <description/>
      <type>SUCCESS</type>
      <attributes/>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>128</xloc>
      <yloc>544</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>MedicoEmAtividadeSitDetalhada</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>CREATE TABLE MedicosEmAtividadeSitDetalhada AS (SELECT 
Id
,SituacaoDetalhada AS IdSituacaoDetalhada
,CASE WHEN SituacaoDetalhada = 1 THEN 'Ativo'
     WHEN SituacaoDetalhada = 2 THEN 'Afastado'
     WHEN SituacaoDetalhada = 3 THEN 'Aposentado'
     WHEN SituacaoDetalhada = 4 THEN 'Cancelado'
     WHEN SituacaoDetalhada = 5 THEN 'Cassado'
     WHEN SituacaoDetalhada = 6 THEN 'Divida Ativa'
     WHEN SituacaoDetalhada = 7 THEN 'Falecido'
     WHEN SituacaoDetalhada = 8 THEN 'Interditado'
     WHEN SituacaoDetalhada = 9 THEN 'Sem Informação'
     WHEN SituacaoDetalhada = 10 THEN 'Suspenso'
     WHEN SituacaoDetalhada = 11 THEN 'Transferido'
ELSE '' END AS  SituacaoDetalhada  
FROM stgmedicosematividade)</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>CFMLocal</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>256</xloc>
      <yloc>240</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>LimparTabelas</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>DROP TABLE IF EXISTS MedicosEmAtividadeSitDetalhada;
DROP TABLE IF EXISTS MedicosEmAtividadeUf;
DROP TABLE IF EXISTS MedicosEmAtividadeMunicipioTemp;
DROP TABLE IF EXISTS MedicosEmAtividadeMunicipio;
DROP TABLE IF EXISTS MedicosEmAtividadeEstratoMunicipio;
DROP TABLE IF EXISTS MedicosEmAtividadeClasseMunicipio;
DROP TABLE IF EXISTS MedicosEmAtividadeMediaIdade;
DROP TABLE IF EXISTS MedicosEmAtividadeEspecialistaGeneralista;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>CFMLocal</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>96</xloc>
      <yloc>240</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>MedicosEmAtividadeUfDeInscricao</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>



CREATE TABLE MedicosEmAtividadeUf AS (SELECT
Id
,UfDeInscricao AS IdUf
,CASE WHEN UfDeInscricao = 1 THEN 'Rondônia'
      WHEN UfDeInscricao = 2 THEN 'Acre'
      WHEN UfDeInscricao = 3 THEN 'Amazonas'
      WHEN UfDeInscricao = 4 THEN 'Roraima'
      WHEN UfDeInscricao = 5 THEN 'Pará'
      WHEN UfDeInscricao = 6 THEN 'Amapa'
      WHEN UfDeInscricao = 7 THEN 'Tocantins'
      WHEN UfDeInscricao = 8 THEN 'Maranhão'
      WHEN UfDeInscricao = 9 THEN 'Piauí'
      WHEN UfDeInscricao = 10 THEN 'Ceara'
      WHEN UfDeInscricao = 11 THEN 'Rio Grande do Norte'
      WHEN UfDeInscricao = 12 THEN 'Paraíba'
      WHEN UfDeInscricao = 13 THEN 'Pernanbuco'
      WHEN UfDeInscricao = 14 THEN 'Alagoas'
      WHEN UfDeInscricao = 15 THEN 'Sergipe'
      WHEN UfDeInscricao = 16 THEN 'Bahia'
      WHEN UfDeInscricao = 17 THEN 'Minas Gerais'
      WHEN UfDeInscricao = 18 THEN 'Espirito Santo'
      WHEN UfDeInscricao = 19 THEN 'Rio de Janeiro'
      WHEN UfDeInscricao = 20 THEN 'São Paulo'
      WHEN UfDeInscricao = 21 THEN 'Paraná'
      WHEN UfDeInscricao = 22 THEN 'Santa Catarina'
      WHEN UfDeInscricao = 23 THEN 'Rio Grande do Sul'
      WHEN UfDeInscricao = 24 THEN 'Mato Grosso do Sul'
      WHEN UfDeInscricao = 25 THEN 'Mato Grosso'
      WHEN UfDeInscricao = 26 THEN 'Goiás'
      WHEN UfDeInscricao = 27 THEN 'Distrito Federal'
ELSE "" END AS UfDeInscricao      
FROM stgmedicosematividade);

</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>CFMLocal</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>256</xloc>
      <yloc>336</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>MunicipioTemp</name>
      <description/>
      <type>TRANS</type>
      <attributes/>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>MedicosEmAtividadeCidadeTemp</transname>
      <directory>/</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <run_configuration>Pentaho local</run_configuration>
      <suppress_result_data>N</suppress_result_data>
      <parameters>
        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>416</xloc>
      <yloc>336</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>MedicosEmAtividadeMunicipioTemp</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>CREATE TABLE  MedicosEmAtividadeMunicipioTemp AS ( 
 SELECT
 idcidade      AS IdMunicipio
,nomecidade    AS NomeMunicipio
FROM tempmedicosematividadecidade
WHERE idcidade NOT IN ('-------'))</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>CFMLocal</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>576</xloc>
      <yloc>336</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>MedicosEmAtividadeMunicipio</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>DROP TABLE IF EXISTS TempMunicipio;

CREATE TABLE TempMunicipio AS (SELECT 
  CAST(A.IdMunicipio AS UNSIGNED) IdMunicipio
 ,A.NomeMunicipio
FROM MedicosEmAtividadeMunicipioTemp A
WHERE A.IdMunicipio != 'campotres'
GROUP BY 
         A.IdMunicipio
        ,A.NomeMunicipio);

CREATE INDEX IndicaTempMunicipio
ON TempMunicipio (IdMunicipio);


CREATE TABLE MedicosEmAtividadeMunicipio AS (SELECT 
 stgmedicosematividade.Id
,TempMunicipio.IdMunicipio
,TempMunicipio.NomeMunicipio
FROM TempMunicipio
INNER JOIN stgmedicosematividade
ON TempMunicipio.IdMunicipio = stgmedicosematividade.Municipio)




</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>CFMLocal</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>800</xloc>
      <yloc>336</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>MedicosEmAtividadeEstratoMunicipio</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>
CREATE TABLE MedicosEmAtividadeEstratoMunicipio AS ( 
SELECT 
 id
,EstratoMunicipio AS IdEstratoMunicipio
,CASE WHEN EstratoMunicipio = 1 THEN 'Até 5 mil'
      WHEN EstratoMunicipio = 2 THEN '5 a 10 mil'
      WHEN EstratoMunicipio = 3 THEN '10 a 20 mil'
      WHEN EstratoMunicipio = 4 THEN '20 a 50 mil'
      WHEN EstratoMunicipio = 5 THEN '50 a 100 mil'
      WHEN EstratoMunicipio = 6 THEN '100 a 500 mil'
      WHEN EstratoMunicipio = 7 THEN '+500 mil'
      ELSE '' END AS EstratoMunicipio
FROM stgmedicosematividade)</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>CFMLocal</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>800</xloc>
      <yloc>432</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>MedicosEmAtividadeClasseMunicipio</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>
CREATE TABLE MedicosEmAtividadeClasseMunicipio AS ( 
SELECT 
 id
,ClasseMunicipio AS IdClasseMunicipio
,CASE WHEN ClasseMunicipio = 2 THEN 'RURAL DENTRO DE RM'
      WHEN ClasseMunicipio = 3 THEN 'RURAL FORA DE RM'
      WHEN ClasseMunicipio = 4 THEN 'RURBANO DENTRO DE RM'
      WHEN ClasseMunicipio = 5 THEN 'RURBANO FORA DE RM'
      WHEN ClasseMunicipio = 6 THEN 'URBANO DENTRO DE RM'
      WHEN ClasseMunicipio = 7 THEN 'URBANO FORA DE RM'
      ELSE '' END AS EstratoMunicipio
FROM stgmedicosematividade)</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>CFMLocal</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>832</xloc>
      <yloc>544</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>MedicosEmAtividadeMediaIdade</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>
CREATE TABLE MedicosEmAtividadeMediaIdade AS ( 
SELECT 
Id
,Idade
,CASE WHEN IdadeCatUm = 0 THEN '&lt;= 29 anos'
      WHEN IdadeCatUm = 1 THEN '30 - 34 anos'
      WHEN IdadeCatUm = 2 THEN '35 - 39 anos'
      WHEN IdadeCatUm = 3 THEN '40 - 44 anos'
      WHEN IdadeCatUm = 4 THEN '45 - 49 anos'
      WHEN IdadeCatUm = 5 THEN '50 - 54 anos'
      WHEN IdadeCatUm = 6 THEN '55 a 59 anos'
      WHEN IdadeCatUm = 7 THEN '60 - 64 anos'
      WHEN IdadeCatUm = 8 THEN '65 - 69 anos'
      WHEN IdadeCatUm = 9 THEN '>= 70 anos'
      ELSE  '' END AS FaixaEtaria
FROM stgmedicosematividade)</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>CFMLocal</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>592</xloc>
      <yloc>544</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>MedicosEmAtividadeEspecialistaGeneralista</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>
CREATE TABLE MedicosEmAtividadeEspecialistaGeneralista AS ( 
SELECT 
Id
,Especialidade AS IdEspecialista
,CASE WHEN Especialidade = 0 THEN 'Generalista'
      WHEN Especialidade = 1 THEN 'Especialista'
ELSE '' END AS EspecialistaGeneralista          
FROM stgmedicosematividade)</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>CFMLocal</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>352</xloc>
      <yloc>544</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>StgMedicosEmAtividade</name>
      <description/>
      <type>TRANS</type>
      <attributes/>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>StgMedicosEmAtividade</transname>
      <directory>/</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <run_configuration>Pentaho local</run_configuration>
      <suppress_result_data>N</suppress_result_data>
      <parameters>
        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>448</xloc>
      <yloc>128</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>JobAuditoria</name>
      <description/>
      <type>JOB</type>
      <attributes/>
      <specification_method>rep_name</specification_method>
      <job_object_id/>
      <filename/>
      <jobname>JobAuditoria</jobname>
      <directory>/</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Nothing</loglevel>
      <slave_server_name/>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <expand_remote_job>N</expand_remote_job>
      <create_parent_folder>N</create_parent_folder>
      <pass_export>N</pass_export>
      <run_configuration>Pentaho local</run_configuration>
      <parameters>
        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>
      <set_append_logfile>N</set_append_logfile>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>288</xloc>
      <yloc>128</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>FimJobStage</name>
      <description/>
      <type>SUCCESS</type>
      <attributes/>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>624</xloc>
      <yloc>128</yloc>
      <attributes_kjc/>
    </entry>
  </entries>
  <hops>
    <hop>
      <from>Verificacao</from>
      <to>MedicosEmAtividade</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>LimparTabelas</from>
      <to>MedicoEmAtividadeSitDetalhada</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Verificacao</from>
      <to>TabelaOriginal</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MedicoEmAtividadeSitDetalhada</from>
      <to>MedicosEmAtividadeUfDeInscricao</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MedicosEmAtividadeUfDeInscricao</from>
      <to>MunicipioTemp</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MunicipioTemp</from>
      <to>MedicosEmAtividadeMunicipioTemp</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MedicosEmAtividadeMunicipioTemp</from>
      <to>MedicosEmAtividadeMunicipio</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MedicosEmAtividadeMunicipio</from>
      <to>MedicosEmAtividadeEstratoMunicipio</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MedicosEmAtividadeEstratoMunicipio</from>
      <to>MedicosEmAtividadeClasseMunicipio</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MedicosEmAtividadeClasseMunicipio</from>
      <to>MedicosEmAtividadeMediaIdade</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MedicosEmAtividadeMediaIdade</from>
      <to>MedicosEmAtividadeEspecialistaGeneralista</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MedicosEmAtividadeEspecialistaGeneralista</from>
      <to>Success</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MedicosEmAtividade</from>
      <to>JobAuditoria</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Start</from>
      <to>Verificacao</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>JobAuditoria</from>
      <to>StgMedicosEmAtividade</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>StgMedicosEmAtividade</from>
      <to>FimJobStage</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>TabelaOriginal</from>
      <to>MedicosEmAtividade</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
  </hops>
  <notepads>
  </notepads>
  <attributes/>
</job>
